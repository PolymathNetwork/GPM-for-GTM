(window.webpackJsonppermissions=window.webpackJsonppermissions||[]).push([[0],{1010:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r.n(n),o=r(12),s=r.n(o),c=(r(399),r(3)),i=r.n(c),l=r(178),u=r(76),d=r(392),p=r(373),m=r(145),f=r(120),E=r(1011),v=r(1019),g=r(1018),b=r(65),y=r(383),O=r(1020),k=r(1012),x=r(1013),h=r(1015),A=r(1014),w=r(142),C=r(1016),S=r(1017),R=r(14),j=r(380),T=r(381),D=x.a.Column,P=h.a.Text,N=A.a.Item,_=w.a.Option,I={labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}},F={StoOperator:"STO Operator",StoAdministrator:"STO Administrator",Erc20DividendsAdministrator:"ERC20 Dividends Administrator",Erc20DividendsOperator:"ERC20 Dividends Operator",PermissionsOperator:"Permissions Operator",TokenholdersOperator:"Tokenholders Operator",PermissionsAdministrator:"Permissions Administrator",TokenholdersAdministrator:"Tokenholders Administrator"};function Y(e){var t=e.records,r=e.revokeRole,o=e.assignRole,s=e.roles,c=Object(j.a)(),d=c.getFieldDecorator,p=c.validateFields,m=c.resetFields,f=Object(n.useState)(!1),E=Object(l.a)(f,2),v=E[0],g=E[1],y=s.map((function(e){return{value:e,label:F[e]}})),O=function(){var e=Object(u.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:p(["address","role","description"],{force:!0}).then(function(){var e=Object(u.a)(i.a.mark((function e(t){var r,n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.address,n=t.description,a=t.role,e.prev=1,e.next=4,o(r,a,n);case 4:m(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),console.error(e.t0);case 10:g(!1);case 11:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return a.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},a.a.createElement(b.a,{type:"primary",onClick:function(){return g(!0)},style:{alignSelf:"flex-end",marginBottom:20}},"Assign a role"),a.a.createElement(C.a,{zIndex:0,title:"Assign a role",okText:"Save",closable:!1,visible:v,footer:null},a.a.createElement(A.a,I,a.a.createElement(N,{name:"address",label:"Address"},d("address",{rules:[{validator:function(e,t,r){t?T.isAddress(t)?r():r("Address is invalid"):r("Address is required")}}]})(a.a.createElement(S.a,null))),a.a.createElement(N,{name:"role",label:"Role"},d("role",{rules:[{required:!0}]})(a.a.createElement(w.a,null,y.map((function(e){var t=e.value,r=e.label;return a.a.createElement(_,{key:r,value:t},r)}))))),a.a.createElement(N,{name:"description",label:"Description"},d("description",{rules:[{required:!0}]})(a.a.createElement(S.a,null))),a.a.createElement(N,null,a.a.createElement(b.a,{onClick:function(){g(!1),m()}},"Cancel"),a.a.createElement(b.a,{type:"primary",onClick:O},"Save")))),a.a.createElement(x.a,{style:{zIndex:0},size:"middle",dataSource:t,rowKey:function(e,t){return"".concat(e,"-").concat(t)}},a.a.createElement(D,{title:"Address",dataIndex:"address",key:"address",render:function(e){return a.a.createElement(P,null,e)}}),a.a.createElement(D,{title:"Role",dataIndex:"role",key:"role",render:function(e){return a.a.createElement(P,null,Q(e))}}),a.a.createElement(D,{title:"Desc",dataIndex:"description",key:"description",render:function(e){return a.a.createElement(P,null,e)}}),a.a.createElement(D,{title:"Actions",render:function(e,t){return a.a.createElement(n.Fragment,null,a.a.createElement(b.a,{onClick:function(){return r(t.address,t.role)}},a.a.createElement(R.a,{type:"delete",theme:"filled"})))}})))}function L(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function M(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?L(Object(r),!0).forEach((function(t){Object(p.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):L(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var K=E.a.Content,z=E.a.Header,B=E.a.Sider,q=f.Feature.Permissions;function J(e){var t=e.features,r=e.pmEnabled,n=e.onClick;return a.a.createElement(v.a,{column:4,style:{marginBottom:50}},a.a.createElement(v.a.Item,{key:"Permissions",label:"Permissions"},r?a.a.createElement(g.a,{status:"success",text:"enabled"}):a.a.createElement(b.a,{type:"primary",onClick:n},"Enable")),"}",Object.keys(t).map((function(e){return a.a.createElement(v.a.Item,{key:e,label:Q(e)},a.a.createElement(g.a,{status:t[e]?"success":"error",text:t[e]?"enabled":"disabled"}))})))}function W(e,t){return H.apply(this,arguments)}function H(){return(H=Object(u.a)(i.a.mark((function e(t,r){var n,a,o=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>2&&void 0!==o[2]?o[2]:"",e.prev=1,t({type:"ASYNC_START",msg:n}),e.next=5,r();case 5:a=e.sent,t(M({type:"ASYNC_COMPLETE"},a)),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),t({type:"ASYNC_ERROR",error:e.t0.message});case 12:case"end":return e.stop()}}),e,null,[[1,9]])})))).apply(this,arguments)}var U=function(){var e=Object(n.useContext)(G),t=Object(l.a)(e,2),r=t[0],o=t[1],s=Object(m.c)(),c=s.error,d=s.sdk,p=s.networkId,f=s.walletAddress,v=Object(m.d)(d,f),g=v.error,b=v.tokenSelector,x=v.tokens,h=v.tokenIndex,A=r.AppReducer,w=A.loading,C=A.loadingMessage,S=A.error,R=A.pmEnabled,j=A.records,T=A.features,D=A.availableRoles,P=x[h];function N(){return(N=Object(u.a)(i.a.mark((function e(t){var r,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,o({type:"ASYNC_START",msg:"Toggle role management"}),!t){e.next=10;break}return e.next=5,P.features.enable({feature:q});case 5:return r=e.sent,e.next=8,r.run();case 8:e.next=15;break;case 10:return e.next=12,P.features.disable({feature:q});case 12:return n=e.sent,e.next=15,n.run();case 15:o({type:"ASYNC_COMPLETE",pmEnabled:!t}),o({type:"TOKEN_SELECTED"}),e.next=23;break;case 19:e.prev=19,e.t0=e.catch(0),console.error(e.t0),o({type:"ASYNC_ERROR",error:e.t0.message});case 23:case"end":return e.stop()}}),e,null,[[0,19]])})))).apply(this,arguments)}(S=S||c||g)||C||(d?x.length||(w=!0,C="Loading your security tokens"):(w=!0,C="Initializing Polymath SDK")),Object(n.useEffect)((function(){function e(){return(e=Object(u.a)(i.a.mark((function e(){var t,r,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.features.getStatus();case 2:if(t=e.sent,r=[],n=t[q],delete t[q],!n){e.next=10;break}return e.next=9,P.permissions.getAvailableRoles();case 9:r=e.sent;case 10:return e.abrupt("return",{availableRoles:r,features:t,pmEnabled:n});case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}P&&!T&&W(o,(function(){return function(){return e.apply(this,arguments)}()}),"Loading features status")}),[o,T,P]),Object(n.useEffect)((function(){function e(){return(e=Object(u.a)(i.a.mark((function e(){var t,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.permissions.getAllDelegates();case 2:return t=e.sent,r=t.reduce((function(e,r,n){return e.concat(r.roles.map((function(e){return{address:t[n].address,description:t[n].description,role:e}})))}),[]),e.abrupt("return",{delegates:t,records:r});case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}P&&R&&W(o,(function(){return function(){return e.apply(this,arguments)}()}),"Loading delegates")}),[R,o,P]);var _=function(){var e=Object(u.a)(i.a.mark((function e(t,r){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,o({type:"ASYNC_START",msg:"Revoking ".concat(r," role from ").concat(t)}),e.next=4,P.permissions.revokeRole({delegateAddress:t,role:r});case 4:return n=e.sent,e.next=7,n.run();case 7:o({type:"ASYNC_COMPLETE"}),o({type:"TOKEN_SELECTED"}),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),console.error(e.t0),o({type:"ASYNC_ERROR",error:e.t0.message});case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t,r){return e.apply(this,arguments)}}(),I=function(){var e=Object(u.a)(i.a.mark((function e(t,r,n){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,o({type:"ASYNC_START",msg:"Assigning ".concat(r," role to ").concat(t)}),e.next=4,P.permissions.assignRole({delegateAddress:t,role:r,description:n});case 4:return a=e.sent,e.next=7,a.run();case 7:o({type:"ASYNC_COMPLETE"}),o({type:"TOKEN_SELECTED"}),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),console.error(e.t0),o({type:"ASYNC_ERROR",error:e.t0.message});case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t,r,n){return e.apply(this,arguments)}}();return a.a.createElement("div",null,a.a.createElement(y.a,{spinning:w,tip:C,size:"large"},a.a.createElement(E.a,null,a.a.createElement(z,{style:{backgroundColor:"white",display:"flex",flexDirection:"row",justifyContent:"flex-end",alignItems:"center"}},a.a.createElement(m.a,{networkId:p}),a.a.createElement(m.b,{walletAddress:f})),a.a.createElement(E.a,null,a.a.createElement(B,{width:350,style:{padding:50,backgroundColor:"#FAFDFF"}},f&&x&&a.a.createElement("div",{style:{display:"flex",flexDirection:"column",width:250,justifyContent:"flex-start"}},b({onTokenSelect:function(){return o({type:"TOKEN_SELECTED"})}}))),a.a.createElement(K,{style:{padding:50,backgroundColor:"#FAFDFF"}},S&&a.a.createElement(O.a,{message:S,type:"error",closable:!0,showIcon:!0}),P&&T&&a.a.createElement(n.Fragment,null,a.a.createElement(k.a,{orientation:"left"},"Token features"),a.a.createElement(J,{features:T,pmEnabled:R,onClick:function(e){return N.apply(this,arguments)}})),P&&D&&j&&a.a.createElement(a.a.Fragment,null,a.a.createElement(k.a,{orientation:"left"},"Delegates (administrators and operators)"),a.a.createElement(Y,{records:j,roles:D,revokeRole:_,assignRole:I})))))))},Z=function(e){return function(t,r){var n,a=Object.keys(e).reduce((function(a,o){return a[o]=e[o](t[o],r),n=n||a[o]!==t[o],a}),{});return n?a:t}}({AppReducer:function(e,t){switch(console.log("ACTION",t),t.type){case"ASYNC_START":return M({},e,{loading:!0,loadingMessage:t.msg,error:void 0});case"ASYNC_COMPLETE":t.type;return M({},e,{},Object(d.a)(t,["type"]),{loading:!1,loadingMessage:"",error:void 0});case"ERROR":case"ASYNC_ERROR":return M({},e,{loading:!1,loadingMessage:"",error:t.error});case"TOKEN_SELECTED":return M({},e,{delegates:void 0,records:void 0,pmEnabled:void 0,error:void 0,features:void 0});default:throw new Error("Unrecognized action type: ".concat(t.type))}}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.d(t,"Store",(function(){return G})),r.d(t,"_split",(function(){return Q}));var $={AppReducer:{sdk:void 0,loading:!1,loadingMessage:"",error:void 0,networkId:-1,walletAddress:"",tokens:[],tokenIndex:void 0,pmEnabled:void 0,delegates:void 0,features:void 0}},G=Object(n.createContext)(),Q=function(e){return e.split(/(?=[A-Z])/).join(" ")};s.a.render(a.a.createElement((function(){var e=Object(n.useReducer)(Z,$);return a.a.createElement(G.Provider,{value:e},a.a.createElement(U,null))}),null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},394:function(e,t,r){e.exports=r(1010)},399:function(e,t,r){},565:function(e,t){},567:function(e,t){},586:function(e,t){},588:function(e,t){},842:function(e,t){}},[[394,1,2]]]);
//# sourceMappingURL=main.e0af0b26.chunk.js.map